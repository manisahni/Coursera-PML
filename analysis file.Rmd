---
title: "Assignment rmd file"
output: word_document
---

#Reading in the data from the dropbox folder

```{r reading in the data,echo=FALSE}
setwd("~/Dropbox/CourseraPML")

set.seed(12345)

training <- read.csv("~/Dropbox/CourseraPML/pml-training.csv", stringsAsFactors=FALSE,na.strings=c("NA","#DIV/0!",""))
testing <- read.csv("~/Dropbox/CourseraPML/pml-testing.csv", stringsAsFactors=FALSE,na.strings=c("NA","#DIV/0!",""))

dim(training)
```

# Partioning the training set into two
Partioning Training data set into two data sets,80% myTraining, 20% for myTesting using the caret package:


```{r,echo=FALSE }
library(caret)
part <- createDataPartition(training$classe,p=.8,list=FALSE) ## create a partion index
mytraining <- training[part,] ; mytesting <- training[-part,] ## use the

```

# Cleaning the data

Methods for cleaning and preparing the data for model training:
1) Remove catagorical variables from dataset including “X”, “user_name”, “raw_timestamp_part_1”, “raw_timestamp_part_2”, “cvtd_timestamp”, “new_window”, “num_window”.
2) Remove any features that have little variance or information value using nearZeroVar().
3) Remove columns with NA values in them.

```{r, echo=FALSE}
library(dplyr) 
mytraining <- mytraining[,-c(1:7)] #Remove catagorical variables 


nzv_list <- as.data.frame(nearZeroVar(mytraining, saveMetrics=TRUE))
remaining <- nzv_list[which(nzv_list$nzv==FALSE),]
df_all_var <- subset(mytraining, select=rownames(remaining))
df_all_var[,colSums(is.na(df_all_var))==0]
# Remove Columsn with NAs
df_rm_na <- df_all_var[ , colSums(is.na(df_all_var)) == 0]
# Find Correlated variables 
df_corr <- cor(subset(df_rm_na, select=-classe)) ##

```

# Making the random forest model

Construct a random foret model. 

```{r, cache=TRUE,eval=FALSE}
library(randomForest)
library(e1071)

set.seed(575656)
### Run full model!
mod_rf_full <- train(classe~ . 
              ,method='rf'
              ,allowParallel=TRUE
              ,data = df_rm_na,do.Trace=TRUE)
```


Save the random forest model for loading in the future.

```{r,eval=FALSE}
save(mod_rf_full, file = "mod_rf_full_002.RData")

```

# Print the final model details for the Random Forest Model

Load back the random forest model and print the results

```{r}
load("/Users/nishantsahni/Dropbox/CourseraPML/mod_rf_full_002.RData")
print(mod_rf_full$finalModel)

```


